package leetcode.arrays.binarySearch;
//ç»™å®šå­—ç¬¦ä¸² s å’Œ t ï¼Œåˆ¤æ–­ s æ˜¯å¦ä¸º t çš„å­åºåˆ—ã€‚
//
// å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­åºåˆ—æ˜¯åŸå§‹å­—ç¬¦ä¸²åˆ é™¤ä¸€äº›ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ é™¤ï¼‰å­—ç¬¦è€Œä¸æ”¹å˜å‰©ä½™å­—ç¬¦ç›¸å¯¹ä½ç½®å½¢æˆçš„æ–°å­—ç¬¦ä¸²ã€‚ï¼ˆä¾‹å¦‚ï¼Œ"ace"æ˜¯"abcde"çš„ä¸€ä¸ªå­åºåˆ—ï¼Œè€Œ
//"aec"ä¸æ˜¯ï¼‰ã€‚
//
// è¿›é˜¶ï¼š
//
// å¦‚æœæœ‰å¤§é‡è¾“å…¥çš„ Sï¼Œç§°ä½œ S1, S2, ... , Sk å…¶ä¸­ k >= 10äº¿ï¼Œä½ éœ€è¦ä¾æ¬¡æ£€æŸ¥å®ƒä»¬æ˜¯å¦ä¸º T çš„å­åºåˆ—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ ä¼šæ€æ ·æ”¹å˜ä»£
//ç ï¼Ÿ
//
// è‡´è°¢ï¼š
//
// ç‰¹åˆ«æ„Ÿè°¢ @pbrother æ·»åŠ æ­¤é—®é¢˜å¹¶ä¸”åˆ›å»ºæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//è¾“å…¥ï¼šs = "abc", t = "ahbgdc"
//è¾“å‡ºï¼štrue
//
//
// ç¤ºä¾‹ 2ï¼š
//
//
//è¾“å…¥ï¼šs = "axc", t = "ahbgdc"
//è¾“å‡ºï¼šfalse
//
//
//
//
// æç¤ºï¼š
//
//
// 0 <= s.length <= 100
// 0 <= t.length <= 10^4
// ä¸¤ä¸ªå­—ç¬¦ä¸²éƒ½åªç”±å°å†™å­—ç¬¦ç»„æˆã€‚
//
//
// Related Topics åŒæŒ‡é’ˆ å­—ç¬¦ä¸² åŠ¨æ€è§„åˆ’ ğŸ‘ 710 ğŸ‘ 0

import java.util.ArrayList;

/**
 * @author mayanwei
 * @date 2022-08-10.
 */
public class _392_åˆ¤æ–­å­åºåˆ—{
    class Solution {
        // åˆ©ç”¨åŒæŒ‡é’ˆ i, j åˆ†åˆ«æŒ‡å‘ s, tï¼Œä¸€è¾¹å‰è¿›ä¸€è¾¹åŒ¹é…å­åºåˆ—
        // è€Œå¦‚æœå·§å¦™è¿ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œå¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™ä½ï¼Œå¤§çº¦æ˜¯ O(MlogN)ã€‚ç”±äº N ç›¸å¯¹ M å¤§å¾ˆå¤šï¼Œæ‰€ä»¥åè€…æ•ˆç‡ä¼šæ›´é«˜
        /**
         äºŒåˆ†æ€è·¯ï¼šä¸»è¦æ˜¯å¯¹ t è¿›è¡Œé¢„å¤„ç†ï¼Œç”¨ä»¥ç»™å­—å…¸ index å°†æ¯ä¸ªå­—ç¬¦å‡ºç°çš„ç´¢å¼•ä½ç½®æŒ‰é¡ºåºå­˜å‚¨ä¸‹æ¥
         */
        public boolean isSubsequence(String s, String t) {
            int m = s.length(), n = t.length();
            ArrayList<Integer> [] index = new ArrayList[256];
            // å…ˆè®°ä¸‹ t ä¸­å¦¹å­å­—ç¬¦å‡ºç°çš„ä½ç½®
            for (int i = 0; i < n; i++) {
                char c = t.charAt(i);
                if (index[c] == null) {
                    index[c] = new ArrayList<>();
                }
                index[c].add(i);
            }

            // ä¸² t ä¸Šçš„æŒ‡é’ˆ
            int j = 0;
            // å€ŸåŠ© index æŸ¥æ‰¾ s[i]
            for (int i = 0; i < m; i++) {
                char c = s.charAt(i);
                // æ•´ä¸ª t å‹æ ¹å„¿æ²¡æœ‰å­—ç¬¦c
                if (index[c] == null) {
                    return false;
                }
                int pos = left_bound(index[c], j);
                // äºŒåˆ†æœç´¢åŒºé—´ä¸­æ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ c
                if (pos == index[c].size()) {
                    return false;
                }
                j = index[c].get(pos) + 1;
            }
            return true;
        }

        // æŸ¥æ‰¾å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾
        // å½“ val ä¸å­˜åœ¨æ—¶ï¼Œå¾—åˆ°çš„ç´¢å¼•æ°å¥½æ˜¯æ¯” val å¤§çš„æœ€å°å…ƒç´ ç´¢å¼•ã€‚
        // ä»€ä¹ˆæ„æ€å‘¢ï¼Œå°±æ˜¯è¯´å¦‚æœåœ¨æ•°ç»„ [0,1,3,4] ä¸­æœç´¢å…ƒç´  2ï¼Œç®—æ³•ä¼šè¿”å›ç´¢å¼• 2ï¼Œä¹Ÿå°±æ˜¯å…ƒç´  3 çš„ä½ç½®ï¼Œå…ƒç´  3 æ˜¯æ•°ç»„ä¸­å¤§äº 2 çš„æœ€å°å…ƒç´ ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨äºŒåˆ†æœç´¢é¿å…çº¿æ€§æ‰«æã€‚
        int left_bound(ArrayList<Integer> arr, int tar) {
            int lo = 0, hi = arr.size();
            while (lo < hi) {
                int mid = lo + (hi - lo)/2;
                if (tar > arr.get(mid)) {
                    lo = mid+1;
                }
                else {
                    hi = mid;
                }
            }
            return lo;
        }
    }
}
