package leetcode.arrays.binarySearch;
//ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° m ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•°ç»„åˆ†æˆ m ä¸ªéç©ºçš„è¿ç»­å­æ•°ç»„ã€‚
//
//è®¾è®¡ä¸€ä¸ªç®—æ³•ä½¿å¾—è¿™ m ä¸ªå­æ•°ç»„å„è‡ªå’Œçš„æœ€å¤§å€¼æœ€å°ã€‚
//
//ç¤ºä¾‹ 1
//è¾“å…¥ï¼šnums = [7,2,5,10,8], m = 2
//è¾“å‡ºï¼š18
//è§£é‡Šï¼š
//ä¸€å…±æœ‰å››ç§æ–¹æ³•å°† nums åˆ†å‰²ä¸º 2 ä¸ªå­æ•°ç»„ã€‚
//å…¶ä¸­æœ€å¥½çš„æ–¹å¼æ˜¯å°†å…¶åˆ†ä¸º [7,2,5] å’Œ [10,8] ã€‚
//å› ä¸ºæ­¤æ—¶è¿™ä¸¤ä¸ªå­æ•°ç»„å„è‡ªçš„å’Œçš„æœ€å¤§å€¼ä¸º18ï¼Œåœ¨æ‰€æœ‰æƒ…å†µä¸­æœ€å°ã€‚
//
//ç¤ºä¾‹ 2ï¼š
//è¾“å…¥ï¼šnums = [1,2,3,4,5], m = 2
//è¾“å‡ºï¼š9
//
//ç¤ºä¾‹ 3ï¼š
//è¾“å…¥ï¼šnums = [1,4,4], m = 3
//è¾“å‡ºï¼š4
//æç¤ºï¼š
//
//1 <= nums.length <= 1000
//0 <= nums[i] <= 106
//1 <= m <= min(50, nums.length)
//Related Topics
//
//ğŸ‘ 724, ğŸ‘ 0

/**
 * å­—èŠ‚
 *
 * @author mayanwei
 * @date 2022-08-17.
 */
public class _410_åˆ†å‰²æ•°ç»„çš„æœ€å¤§å€¼{
    class Solution{
        // 1ã€å¯¹maxå˜é‡çš„ç©·ä¸¾æ˜¯ä»loåˆ°hiå³ä»å°åˆ°å¤§çš„ã€‚
        // è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ±‚çš„æ˜¯ã€Œæœ€å¤§å­æ•°ç»„å’Œã€çš„ã€Œæœ€å°å€¼ã€ï¼Œä¸”splitå‡½æ•°çš„è¿”å›å€¼æœ‰å•è°ƒæ€§ï¼Œæ‰€ä»¥ä»å°åˆ°å¤§éå†ï¼Œç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å€¼å°±æ˜¯ã€Œæœ€å°å€¼ã€ã€‚
        // 2ã€å‡½æ•°è¿”å›çš„æ¡ä»¶æ˜¯n <= mï¼Œè€Œä¸æ˜¯n == mã€‚æŒ‰ç…§ä¹‹å‰çš„æ€è·¯ï¼Œåº”è¯¥n == mæ‰å¯¹å§ï¼Ÿ
        // å…¶å®ï¼Œsplitå‡½æ•°é‡‡ç”¨äº†è´ªå¿ƒçš„ç­–ç•¥ï¼Œè®¡ç®—çš„æ˜¯maxé™åˆ¶ä¸‹è‡³å°‘èƒ½å¤Ÿå°†numsåˆ†å‰²æˆå‡ ä¸ªå­æ•°ç»„ã€‚
        // ä¸¾ä¸ªä¾‹å­ï¼Œè¾“å…¥nums = [2,1,1], m = 3ï¼Œæ˜¾ç„¶åˆ†å‰²æ–¹æ³•åªæœ‰ä¸€ç§ï¼Œå³æ¯ä¸ªå…ƒç´ éƒ½è®¤ä¸ºæ˜¯ä¸€ä¸ªå­æ•°ç»„ï¼Œæœ€å¤§å­æ•°ç»„å’Œä¸º 2ã€‚
        // ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„ç®—æ³•ä¼šåœ¨åŒºé—´[2,4]ç©·ä¸¾maxï¼Œå½“max = 2æ—¶ï¼Œsplitä¼šç®—å‡ºnumsè‡³å°‘å¯ä»¥è¢«åˆ†å‰²æˆn = 2ä¸ªå­æ•°ç»„[2]å’Œ[1,1]ã€‚
        // å½“max = 3æ—¶ç®—å‡ºn = 2ï¼Œå½“max = 4æ—¶ç®—å‡ºn = 1ï¼Œæ˜¾ç„¶éƒ½æ˜¯å°äºm = 3çš„ã€‚
        // æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç”¨n == mè€Œå¿…é¡»ç”¨n <= mæ¥æ‰¾åˆ°ç­”æ¡ˆï¼Œå› ä¸ºå¦‚æœä½ èƒ½æŠŠnumsåˆ†å‰²æˆ 2 ä¸ªå­æ•°ç»„ï¼ˆ[2],[1,1]ï¼‰ï¼Œ
        // é‚£ä¹ˆè‚¯å®šä¹Ÿå¯ä»¥åˆ†å‰²æˆ 3 ä¸ªå­æ•°ç»„ï¼ˆ[2],[1],[1]ï¼‰ã€‚

        /**
         * åœ¨æ¯ä¸ªå­æ•°ç»„å’Œä¸è¶…è¿‡ max çš„æ¡ä»¶ä¸‹ï¼Œè®¡ç®— nums è‡³å°‘å¯ä»¥åˆ†å‰²æˆå‡ ä¸ªå­æ•°ç»„ï¼Œ
         * <p>
         * å› æ­¤è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæœ€å° max å€¼ï¼Œæ»¡è¶³ split(nums, max) å’Œ m ç›¸ç­‰ï¼Œ
         * é‚£ä¹ˆè¿™ä¸ªæœ€å°çš„max å°±æ˜¯ç¬¦åˆé¢˜æ„çš„ã€æœ€å°çš„æœ€å¤§å­æ•°ç»„å’Œã€‘
         * <p>
         * ç°åœ¨å°±ç®€å•äº†ï¼Œæˆ‘ä»¬åªè¦å¯¹maxè¿›è¡Œç©·ä¸¾å°±è¡Œï¼Œé‚£ä¹ˆæœ€å¤§å­æ•°ç»„å’Œmaxçš„å–å€¼èŒƒå›´æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
         * <p>
         * æ˜¾ç„¶ï¼Œå­æ•°ç»„è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼Œè‡³å¤šåŒ…å«æ•´ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ã€Œæœ€å¤§ã€å­æ•°ç»„å’Œçš„å–å€¼èŒƒå›´
         * å°±æ˜¯é—­åŒºé—´[max(nums), sum(nums)]ï¼Œä¹Ÿå°±æ˜¯æœ€å¤§å…ƒç´ å€¼åˆ°æ•´ä¸ªæ•°ç»„å’Œä¹‹é—´ã€‚
         * <p>
         * æ—¶é—´å¤æ‚åº¦åˆ†æï¼šå‡è®¾numså…ƒç´ ä¸ªæ•°ä¸ºNï¼Œå…ƒç´ å’Œä¸ºSï¼Œåˆ™splitå‡½æ•°çš„å¤æ‚åº¦ä¸ºO(N)ï¼Œ
         * äºŒåˆ†æŸ¥æ‰¾çš„å¤æ‚åº¦ä¸ºO(logS)ï¼Œæ‰€ä»¥ç®—æ³•çš„æ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(N*logS)ã€‚
         */
        public int splitArray(int[] nums, int m) {
            // int lo = Arrays.stream(nums).max().getAsInt(), hi = Arrays.stream(nums).sum() + 1;
            int lo = getMax(nums), hi = getSum(nums) + 1;
            // for (int max = lo; max<= hi; max++) {
            //     // å¦‚æœæœ€å¤§å­æ•°ç»„å’Œæ—¶ max
            //     // è‡³å°‘å¯ä»¥æŠŠnumsåˆ†å‰²æˆnä¸ªå­æ•°ç»„
            //     int n = split(nums, max);
            //     // ä¸ºä»€ä¹ˆæ—¶ <= è€Œä¸æ˜¯ ==

            //     if (n <= m) {
            //         return max;
            //     }
            // }
            // å¯èƒ½å­˜åœ¨å¤šä¸ªmaxä½¿å¾—split(nums, max)ç®—å‡ºç›¸åŒçš„nï¼Œå› ä¸ºæˆ‘ä»¬çš„ç®—æ³•ä¼šè¿”å›æœ€å°çš„é‚£ä¸ªmaxï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨æœç´¢å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ã€‚
            // åœ¨[lo, hi] ä¸­æœç´¢ä¸€ä¸ªæœ€å°çš„ maxï¼Œä½¿å¾— split(nums, max) æ°å¥½ç­‰äº m
            while (lo < hi) {
                int mid = lo + (hi - lo) / 2;
                // æ ¹æ®åˆ†å‰²å­æ•°ç»„çš„ä¸ªæ•°æ”¶ç¼©æœç´¢åŒºé—´
                int n = split(nums, mid);
                if (n == m) {
                    // æ”¶ç¼©å³è¾¹ç•Œï¼Œè¾¾åˆ°æœç´¢å·¦è¾¹ç•Œçš„ç›®çš„
                    hi = mid;
                }
                else if (n < m) {
                    // æœ€å¤§æ•°ç»„å’Œçš„ä¸Šé™é«˜äº†ï¼Œæ”¶ç¼©å³è¾¹ç•Œ
                    hi = mid;
                }
                else if (n > m) {
                    // æœ€å¤§æ•°ç»„å’Œçš„ä¸Šé™ä½äº†ï¼Œå¢åŠ ä¸€äº›
                    lo = mid + 1;
                }
            }
            return lo;
        }

        /**
         * è‹¥é™åˆ¶æœ€å¤§å­æ•°ç»„å’Œä¸º max ï¼Œ
         * è®¡ç®— nums è‡³å°‘å¯ä»¥åˆ†å‰²æˆå‡ ä¸ªå­æ•°ç»„
         */
        int split(int[] nums, int max) {
            // è‡³å°‘å¯ä»¥åˆ†å‰²æˆ1ä¸ª
            int count = 1;
            // è®°å½•æ¯ä¸ªå­æ•°ç»„çš„å…ƒç´ å’Œ
            int sum = 0;
            for (int i = 0; i < nums.length; i++) {
                if (sum + nums[i] > max) {
                    // å¦‚æœå½“å‰å­æ•°ç»„å’Œå¤§äº max é™åˆ¶
                    // åˆ™è¿™ä¸ªå­æ•°ç»„ä¸èƒ½åœ¨æ·»åŠ å…ƒç´ äº†
                    count++;
                    sum = nums[i];
                }
                else {
                    // å½“å‰å­æ•°ç»„å’Œè¿˜æ²¡æœ‰è¾¾åˆ° max é™åˆ¶
                    // è¿˜å¯ä»¥æ·»åŠ å…ƒç´ 
                    sum += nums[i];
                }
            }
            return count;
        }

        // è®¡ç®—æ•°ç»„ä¸­çš„æœ€å¤§å€¼
        int getMax(int[] nums) {
            int res = 0;
            for (int n : nums)
                res = Math.max(n, res);
            return res;
        }

        // è®¡ç®—æ•°ç»„å…ƒç´ å’Œ
        int getSum(int[] nums) {
            int res = 0;
            for (int n : nums)
                res += n;
            return res;
        }

    }
}
