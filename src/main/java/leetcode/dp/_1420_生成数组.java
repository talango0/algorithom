package leetcode.dp;
//ç»™ä½ ä¸‰ä¸ªæ•´æ•° nã€m å’Œ k ã€‚ä¸‹å›¾æè¿°çš„ç®—æ³•ç”¨äºæ‰¾å‡ºæ­£æ•´æ•°æ•°ç»„ä¸­æœ€å¤§çš„å…ƒç´ ã€‚
//
//
//
// è¯·ä½ ç”Ÿæˆä¸€ä¸ªå…·æœ‰ä¸‹è¿°å±æ€§çš„æ•°ç»„ arr ï¼š
//
//
// arr ä¸­æœ‰ n ä¸ªæ•´æ•°ã€‚
// 1 <= arr[i] <= m å…¶ä¸­ (0 <= i < n) ã€‚
// å°†ä¸Šé¢æåˆ°çš„ç®—æ³•åº”ç”¨äº arr ï¼Œsearch_cost çš„å€¼ç­‰äº k ã€‚
//
//
// è¿”å›ä¸Šè¿°æ¡ä»¶ä¸‹ç”Ÿæˆæ•°ç»„ arr çš„ æ–¹æ³•æ•° ï¼Œç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œæ‰€ä»¥ å¿…é¡» å¯¹ 10^9 + 7 å–ä½™ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
// è¾“å…¥ï¼šn = 2, m = 3, k = 1
//è¾“å‡ºï¼š6
//è§£é‡Šï¼šå¯èƒ½çš„æ•°ç»„åˆ†åˆ«ä¸º [1, 1], [2, 1], [2, 2], [3, 1], [3, 2] [3, 3]
//
//
// ç¤ºä¾‹ 2ï¼š
//
// è¾“å…¥ï¼šn = 5, m = 2, k = 3
//è¾“å‡ºï¼š0
//è§£é‡Šï¼šæ²¡æœ‰æ•°ç»„å¯ä»¥æ»¡è¶³ä¸Šè¿°æ¡ä»¶
//
//
// ç¤ºä¾‹ 3ï¼š
//
// è¾“å…¥ï¼šn = 9, m = 1, k = 1
//è¾“å‡ºï¼š1
//è§£é‡Šï¼šå¯èƒ½çš„æ•°ç»„åªæœ‰ [1, 1, 1, 1, 1, 1, 1, 1, 1]
//
//
// ç¤ºä¾‹ 4ï¼š
//
// è¾“å…¥ï¼šn = 50, m = 100, k = 25
//è¾“å‡ºï¼š34549172
//è§£é‡Šï¼šä¸è¦å¿˜äº†å¯¹ 1000000007 å–ä½™
//
//
// ç¤ºä¾‹ 5ï¼š
//
// è¾“å…¥ï¼šn = 37, m = 17, k = 7
//è¾“å‡ºï¼š418930126
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= n <= 50
// 1 <= m <= 100
// 0 <= k <= n
//
//
// Related Topics åŠ¨æ€è§„åˆ’ ğŸ‘ 71 ğŸ‘ 0


/**
 * @author mayanwei
 * @date 2022-09-14.
 */
public class _1420_ç”Ÿæˆæ•°ç»„{
    /**
     * <pre>
     *                                 j-1
     * f[i][s][j] = f[i-1][s][j] * j +  âˆ‘ f[i-1][s-1][j]
     *                                  1
     * i è¡¨è¿°æ•°ç»„é•¿åº¦ä¸ºi
     * s è¡¨ç¤ºæœç´¢ä»£ä»·ä¸ºs
     * j è¡¨ç¤ºæ•°ç»„ä¸­æœ€å¤§æ•°ä¸ºj
     *
     * æ—¶é—´å¤æ‚åº¦ O(N*M^2*K)
     * ç©ºé—´å¤æ‚åº¦ O(N*M*K)
     * </pre>
     */
    class Solution{
        int[][][] f = new int[51][51][101];
        final int MOD = 1000000007;

        public int numOfArrays(int n, int m, int k) {
            // ä¸å­˜åœ¨æœç´¢ä»£ä»·ä¸º 0 çš„æ•°ç»„
            if (k == 0) {
                return 0;
            }

            // è¾¹ç•Œæ¡ä»¶ï¼Œæ‰€æœ‰é•¿åº¦ä¸º 1 çš„æ•°ç»„çš„æœç´¢ä»£ä»·éƒ½ä¸º 1
            for (int j = 1; j <= m; j++) {
                f[1][1][j] = 1;
            }
            for (int i = 2; i <= n; ++i) {
                // æœç´¢ä»£ä»·ä¸ä¼šè¶…è¿‡æ•°ç»„é•¿åº¦
                for (int s = 1; s <= k && s <= i; ++s) {
                    for (int j = 1; j <= m; ++j) {
                        f[i][s][j] = (int) ((long) f[i - 1][s][j] * j % MOD);
                        for (int j0 = 1; j0 < j; ++j0) {
                            f[i][s][j] += f[i - 1][s - 1][j0];
                            f[i][s][j] %= MOD;
                        }
                    }
                }
            }

            // æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯æ‰€æœ‰ f[n][k][..] çš„å’Œ
            // å³æ•°ç»„é•¿åº¦ä¸º nï¼Œæœç´¢ä»£ä»·ä¸º kï¼Œæœ€å¤§å€¼ä»»æ„
            int ans = 0;
            for (int j = 1; j <= m; ++j) {
                ans += f[n][k][j];
                ans %= MOD;
            }
            return ans;
        }
    }


    /**
     * å‰ç¼€å’Œä¼˜åŒ–
     * æ—¶é—´å¤æ‚åº¦ O(N*M^2*K)
     * ç©ºé—´å¤æ‚åº¦ O(N*M*K)
     */
    class Solution0{
        int[][][] f = new int[51][51][101];
        final int MOD = 1000000007;

        public int numOfArrays(int n, int m, int k) {
            // ä¸å­˜åœ¨æœç´¢ä»£ä»·ä¸º 0 çš„æ•°ç»„
            if (k == 0) {
                return 0;
            }

            // è¾¹ç•Œæ¡ä»¶ï¼Œæ‰€æœ‰é•¿åº¦ä¸º 1 çš„æ•°ç»„çš„æœç´¢ä»£ä»·éƒ½ä¸º 1
            for (int j = 1; j <= m; j++) {
                f[1][1][j] = 1;
            }
            for (int i = 2; i <= n; ++i) {
                // æœç´¢ä»£ä»·ä¸ä¼šè¶…è¿‡æ•°ç»„é•¿åº¦
                for (int s = 1; s <= k && s <= i; ++s) {
                    // åˆ©ç”¨å‰ç¼€å’Œä¼˜åŒ–
                    int preSum_j = 0;
                    for (int j = 1; j <= m; j++) {
                        f[i][s][j] = (int) ((long) f[i - 1][s][j] * j % MOD);
                        f[i][s][j] = (f[i][s][j] + preSum_j) % MOD;
                        preSum_j = (preSum_j + f[i-1][s-1][j]) % MOD;
                    }
                }
            }

            // æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯æ‰€æœ‰ f[n][k][..] çš„å’Œ
            // å³æ•°ç»„é•¿åº¦ä¸º nï¼Œæœç´¢ä»£ä»·ä¸º kï¼Œæœ€å¤§å€¼ä»»æ„
            int ans = 0;
            for (int j = 1; j <= m; ++j) {
                ans += f[n][k][j];
                ans %= MOD;
            }
            return ans;
        }
    }
}
