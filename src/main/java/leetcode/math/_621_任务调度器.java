package leetcode.math;
//ç»™ä½ ä¸€ä¸ªç”¨å­—ç¬¦æ•°ç»„ tasks è¡¨ç¤ºçš„ CPU éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ã€‚å…¶ä¸­æ¯ä¸ªå­—æ¯è¡¨ç¤ºä¸€ç§ä¸åŒç§ç±»çš„ä»»åŠ¡ã€‚ä»»åŠ¡å¯ä»¥ä»¥ä»»æ„é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡éƒ½å¯ä»¥åœ¨ 1 ä¸ª
//å•ä½æ—¶é—´å†…æ‰§è¡Œå®Œã€‚åœ¨ä»»ä½•ä¸€ä¸ªå•ä½æ—¶é—´ï¼ŒCPU å¯ä»¥å®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Œæˆ–è€…å¤„äºå¾…å‘½çŠ¶æ€ã€‚
//
// ç„¶è€Œï¼Œä¸¤ä¸ª ç›¸åŒç§ç±» çš„ä»»åŠ¡ä¹‹é—´å¿…é¡»æœ‰é•¿åº¦ä¸ºæ•´æ•° n çš„å†·å´æ—¶é—´ï¼Œå› æ­¤è‡³å°‘æœ‰è¿ç»­ n ä¸ªå•ä½æ—¶é—´å†… CPU åœ¨æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œæˆ–è€…åœ¨å¾…å‘½çŠ¶æ€ã€‚
//
// ä½ éœ€è¦è®¡ç®—å®Œæˆæ‰€æœ‰ä»»åŠ¡æ‰€éœ€è¦çš„ æœ€çŸ­æ—¶é—´ ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//è¾“å…¥ï¼štasks = ["A","A","A","B","B","B"], n = 2
//è¾“å‡ºï¼š8
//è§£é‡Šï¼šA -> B -> (å¾…å‘½) -> A -> B -> (å¾…å‘½) -> A -> B
//     åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ªç›¸åŒç±»å‹ä»»åŠ¡ä¹‹é—´å¿…é¡»é—´éš”é•¿åº¦ä¸º n = 2 çš„å†·å´æ—¶é—´ï¼Œè€Œæ‰§è¡Œä¸€ä¸ªä»»åŠ¡åªéœ€è¦ä¸€ä¸ªå•ä½æ—¶é—´ï¼Œæ‰€ä»¥ä¸­é—´å‡ºç°äº†ï¼ˆå¾…å‘½ï¼‰çŠ¶æ€ã€‚
//
// ç¤ºä¾‹ 2ï¼š
//
//
//è¾“å…¥ï¼štasks = ["A","A","A","B","B","B"], n = 0
//è¾“å‡ºï¼š6
//è§£é‡Šï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»»ä½•å¤§å°ä¸º 6 çš„æ’åˆ—éƒ½å¯ä»¥æ»¡è¶³è¦æ±‚ï¼Œå› ä¸º n = 0
//["A","A","A","B","B","B"]
//["A","B","A","B","A","B"]
//["B","B","B","A","A","A"]
//...
//è¯¸å¦‚æ­¤ç±»
//
//
// ç¤ºä¾‹ 3ï¼š
//
//
//è¾“å…¥ï¼štasks = ["A","A","A","A","A","A","B","C","D","E","F","G"], n = 2
//è¾“å‡ºï¼š16
//è§£é‡Šï¼šä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š
//     A -> B -> C -> A -> D -> E -> A -> F -> G -> A -> (å¾…å‘½) -> (å¾…å‘½) -> A -> (å¾…
//å‘½) -> (å¾…å‘½) -> A
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= task.length <= 10â´
// tasks[i] æ˜¯å¤§å†™è‹±æ–‡å­—æ¯
// n çš„å–å€¼èŒƒå›´ä¸º [0, 100]
//
//
// Related Topics è´ªå¿ƒ æ•°ç»„ å“ˆå¸Œè¡¨ è®¡æ•° æ’åº å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰ ğŸ‘ 1026 ğŸ‘ 0

import java.util.*;

/**
 * @author mayanwei
 * @date 2022-09-29.
 */
public class _621_ä»»åŠ¡è°ƒåº¦å™¨{
    /**
     * æ¨¡æ‹Ÿ
     * æ—¶é—´å¤æ‚åº¦ï¼š O(|tasks| *n) n:ä»»åŠ¡çš„ç§ç±»ï¼Œæœ¬é¢˜ä¸­ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œå› æ­¤ nä¸ä¼šè¶…è¿‡26
     * ç©ºé—´è´Ÿè½½åº¦ï¼š O(n)
     */
    class Solution{
        public int leastInterval(char[] tasks, int n) {
            Map<Character, Integer> freq = new HashMap<>();
            for (char ch : tasks) {
                freq.put(ch, freq.getOrDefault(ch, 0) + 1);
            }

            //ä»»åŠ¡æ€»æ•°
            int m = freq.size();
            //(nextValid_i, rest_i) è¡¨ç¤ºç¬¬ i ä¸ªä»»åŠ¡ï¼Œ
            // å…¶ä¸­ nextValid_i è¡¨ç¤ºå…¶å› å†·å´é™åˆ¶ï¼Œæœ€æ—©å¯ä»¥æ‰§è¡Œçš„æ—¶é—´ï¼Œrest_i è¡¨ç¤ºå…¶å‰©ä½™æ‰§è¡Œæ¬¡æ•°ã€‚
            // åˆå§‹ nextValid_i å‡ä¸º1ï¼Œ rest_i å³ä¸ºä»»åŠ¡ i åœ¨æ•°ç»„ tasks ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚
            List<Integer> nextValid = new ArrayList<>();
            List<Integer> rest = new ArrayList<>();
            Set<Map.Entry<Character, Integer>> entrySet = freq.entrySet();
            for (Map.Entry<Character, Integer> entry : entrySet) {
                int value = entry.getValue();
                nextValid.add(1);
                rest.add(value);
            }

            int time = 0;
            for (int i = 0; i < tasks.length; i++) {
                time++;
                int minNextValid = Integer.MAX_VALUE;
                for (int j = 0; j < m; j++) {
                    if (rest.get(j) != 0) {
                        minNextValid = Math.min(minNextValid, nextValid.get(j));
                    }
                }
                time = Math.max(time, minNextValid);
                int best = -1;
                for (int j = 0; j < m; j++) {
                    if (rest.get(j) != 0 && nextValid.get(j) <= time) {
                        if (best == -1 || rest.get(j) > rest.get(best)) {
                            best = j;
                        }
                    }
                }
                nextValid.set(best, time + n + 1);
                rest.set(best, rest.get(best) - 1);
            }
            return time;
        }
    }


    /**
     * æ„é€ 
     * â—€â”€â”€n+1â”€â”€â”€â–¶
     * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     * â”‚A B C D F G Xâ”‚
     * â”‚A B C D E F Xâ”‚
     * â”‚A B C D E F Gâ”‚
     * â”‚A B C D E F Gâ”‚
     * â”‚A B C        â”‚
     * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     * æ­¤æ—¶n + 1 = 5ï¼Œä½†æˆ‘ä»¬å¡«äº†7åˆ—ï¼Œæ ‡è®° X çš„æ ¼å­è¡¨ç¤º CPU çš„å¾…å‘½çŠ¶æ€ã€‚
     * å¦‚æœæˆ‘ä»¬å¡«ã€è¶…å‡ºã€‘äº† n+1 åˆ—ï¼Œé‚£ä¹ˆæ‰€æœ‰ CPU å¾…å‘½çš„çŠ¶æ€éƒ½æ˜¯å¯ä»¥çœå»çš„ã€‚è¿™æ—¶åº”ä¸ºå¾…å‘½çŠ¶æ€æœ¬èº«åªæ˜¯ä¸ºäº†è§„å®šä»»æ„ä¸¤ä¸ªç›¸é‚»ä»»åŠ¡çš„æ‰§è¡Œé—´éš”è‡³å°‘ä¸º n
     * ä½†å¦‚æœåˆ—æ•°è¶…è¿‡äº† n + 1ï¼Œé‚£ä¹ˆå°±ç®—æ²¡æœ‰è¿™äº›å¾…å‘½çŠ¶æ€ï¼Œä»»æ„ä¸¤ä¸ªç›¸é‚»ä»»åŠ¡çš„æ‰§è¡Œé—´éš”è‚¯å®šä¹Ÿä¼šè‡³å°‘ä¸º nã€‚æ­¤æ—¶æ€»æ‰§è¡Œæ—¶é—´ä¸ºä»»åŠ¡çš„æ€»æ•° ï½œtaskï½œã€‘
     */
    class Solution2{
        public int leastInterval(char[] tasks, int n) {

            int m = tasks.length;
            int[] cnts = new int[26];
            for (char c : tasks) {
                cnts[c - 'A']++;
            }
            int max = 0, cnt = 0;
            for (int i = 0; i < 26; i++) {
                if (cnts[i] > max) {
                    max = cnts[i];
                    cnt = 1;
                }
                else if (cnts[i] == max) {
                    cnt++;
                }
            }
            // æœ€å¤šæ•°é‡çš„ä»»åŠ¡ä¹‹é—´ä¸æ”¾æ»¡ï¼š(max - 1) * (n + 1) + cnt
            // æœ€å¤šæ•°é‡çš„ä»»åŠ¡ä¹‹é—´éƒ½æ”¾æ»¡ï¼Œå¹¶ä¸”æœ‰æº¢å‡ºï¼šm
            return Math.max((max - 1) * (n + 1) + cnt, m);
        }
    }

}
